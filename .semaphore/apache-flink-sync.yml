version: v1.0
name: build-test-release
agent:
  machine:
    type: s1-prod-ubuntu20-04-amd64-1
execution_time_limit:
  minutes: 60

global_job_config:
  secrets:
    - name: vault_sem2_approle
  prologue:
    commands:
      - . vault-sem-get-secret ssh_id_rsa
      - . vault-sem-get-secret netrc
      - . vault-sem-get-secret ssh_config
      - . vault-sem-get-secret gitconfig
blocks:
  - name: Sync Branches
    commands:
      - checkout
      - tools/ci/apache_flink_sync.sh false

